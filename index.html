<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Appointment Booking</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">

<style>
:root {
  --primary: #0a6b3b;
  --danger: #f44336;
  --background: #e0f7fa;
  --card-bg: #ffffff;
  --font-family: 'Poppins', sans-serif;
  --shadow: rgba(0, 0, 0, 0.1);
}

body {
  font-family: var(--font-family);
  background-color: var(--background);
  min-height: 100vh;
  padding: 20px;
  display: flex;
  flex-direction: column;
  align-items: center;
}

.container {
  width: 100%;
  max-width: 800px;
  padding: 2.5rem 3rem;
  background-color: var(--card-bg);
  box-shadow: 0 8px 20px var(--shadow);
  border-radius: 12px;
}

h1 { text-align: center; color: var(--primary); }
.subtitle { text-align: center; color: #666; margin-bottom: 2rem; }

label { display: block; margin-bottom: 6px; font-weight: 600; color: #333; }
select, input {
  width: 100%;
  padding: 12px 14px;
  margin-bottom: 18px;
  border-radius: 8px;
  border: 1px solid #ccc;
  font-size: 1rem;
  background-color: #fafafa;
}

input.invalid, select.invalid {
  border-color: red;
}

.button-group {
  display: flex;
  justify-content: space-between;
  gap: 1rem;
  margin-top: 30px;
}

.button-group button {
  padding: 14px;
  font-size: 1rem;
  font-weight: 600;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  flex: 1;
  transition: background 0.3s ease;
}

.btn-auth { background-color: var(--primary); color: white; }
.btn-auth:hover { background-color: #2a8a55; }
.btn-back { background-color: var(--danger); color: white; }
.btn-back:hover { background-color: #d32f2f; }
</style>
</head>

<body>
<main class="container">
  <h1>Biometrics Appointment Booking</h1>
  <p class="subtitle">Please capture your details as they appear on your identity document.</p>

  <form id="bookingForm">
    <div class="form-group">
      <label for="id_number">ID Number *</label>
      <input id="id_number" name="id_number" type="text" required />
    </div>

    <div class="form-group">
      <label for="forenames">Full Forenames *</label>
      <input id="forenames" name="forenames" type="text" required />
    </div>

    <div class="form-group">
      <label for="surname">Surname *</label>
      <input id="surname" name="surname" type="text" required />
    </div>

    <div class="form-group">
      <label for="country">Country *</label>
      <select id="country" name="country" required onchange="updateLocations()">
        <option value="">Select Country</option>
        <option value="Eswatini">Eswatini</option>
        <option value="South Africa">South Africa</option>
        <option value="Kenya">Kenya</option>
        <option value="Ghana">Ghana</option>
        <option value="Nigeria">Nigeria</option>
      </select>
    </div>

    <div class="form-group">
      <label for="location">Location *</label>
      <select id="location" name="location" required onchange="updateOffices()">
        <option value="">Select Location</option>
      </select>
    </div>

    <div class="form-group">
      <label for="office">Office *</label>
      <select id="office" name="office" required>
        <option value="">Select Office</option>
      </select>
    </div>

    <div class="form-group">
      <label for="appointment_date">Appointment Date *</label>
      <input id="appointment_date" name="appointment_date" type="text" required />
    </div>

    <div class="form-group">
      <label for="appointment_time">Appointment Time *</label>
      <select id="appointment_time" name="appointment_time" required>
        <option value="">-- Select a time slot --</option>
        <option value="08:00-09:00">8am - 9am</option>
        <option value="10:00-11:00">10am - 11am</option>
        <option value="12:00-13:00">12pm - 1pm</option>
        <option value="13:00-14:00">1pm - 2pm</option>
        <option value="14:00-15:00">2pm - 3pm</option>
        <option value="15:00-16:00">3pm - 4pm</option>
      </select>
    </div>

    <div class="button-group">
      <button type="button" class="btn-back" onclick="window.location.href='https://gov.sz/index.php?view=category&id=238'">Back to Website</button>
      <button type="submit" class="btn-auth">Submit</button>
    </div>
  </form>
</main>

<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script>
const countryLocations = {
  'Eswatini': ['Mbabane', 'Manzini', 'Lobamba'],
  'South Africa': ['Pretoria', 'Johannesburg', 'Cape Town'],
  'Kenya': ['Nairobi', 'Mombasa', 'Kisumu'],
  'Ghana': ['Accra', 'Kumasi', 'Tamale'],
  'Nigeria': ['Lagos', 'Abuja', 'Port Harcourt'],
};

const officeLocations = {
  'Mbabane': ['Main Office', 'Regional Office 1', 'Regional Office 2'],
  'Manzini': ['Main Office', 'Branch 1', 'Branch 2'],
  'Lobamba': ['Main Office'],
  'Pretoria': ['Main Office', 'Branch 1', 'Branch 2'],
  'Johannesburg': ['Main Office', 'Branch 1'],
  'Cape Town': ['Main Office'],
  'Nairobi': ['Main Office', 'Branch 1'],
  'Mombasa': ['Main Office'],
  'Kisumu': ['Branch 1'],
  'Accra': ['Main Office', 'Branch 1'],
  'Kumasi': ['Branch 1'],
  'Tamale': ['Branch 1'],
  'Lagos': ['Main Office', 'Branch 1', 'Branch 2'],
  'Abuja': ['Main Office'],
  'Port Harcourt': ['Branch 1'],
};

function updateLocations() {
  const country = document.getElementById('country').value;
  const locationSelect = document.getElementById('location');
  const officeSelect = document.getElementById('office');
  locationSelect.innerHTML = '<option value="">Select Location</option>';
  officeSelect.innerHTML = '<option value="">Select Office</option>';
  if(countryLocations[country]) {
    countryLocations[country].forEach(loc=>{
      const opt=document.createElement('option');
      opt.value=loc;
      opt.textContent=loc;
      locationSelect.appendChild(opt);
    });
  }
}

function updateOffices() {
  const location = document.getElementById('location').value;
  const officeSelect = document.getElementById('office');
  officeSelect.innerHTML = '<option value="">Select Office</option>';
  if(officeLocations[location]) {
    officeLocations[location].forEach(off=>{
      const opt=document.createElement('option');
      opt.value=off;
      opt.textContent=off;
      officeSelect.appendChild(opt);
    });
  }
}

flatpickr("#appointment_date", {
  dateFormat: "Y-m-d",
  minDate: "today"
});

document.getElementById("bookingForm").addEventListener("submit", function(e){
  e.preventDefault();
  let isValid = true;
  // Check required fields
  this.querySelectorAll('[required]').forEach(input=>{
    if(!input.value.trim()){
      input.classList.add('invalid');
      isValid = false;
    } else {
      input.classList.remove('invalid');
    }
  });

  if(!isValid) return;

  // Save data
  const bookingData = {
    id_number: document.getElementById("id_number").value,
    forenames: document.getElementById("forenames").value,
    surname: document.getElementById("surname").value,
    country: document.getElementById("country").value,
    location: document.getElementById("location").value,
    office: document.getElementById("office").value,
    appointment_date: document.getElementById("appointment_date").value,
    appointment_time: document.getElementById("appointment_time").value,
  };
  localStorage.setItem("bookingData", JSON.stringify(bookingData));
  window.location.href = "summary.html";
});
</script>
</body>
</html>
