<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Visa Application</title>

<style>
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');

:root {
  --card: #ffffff;
  --muted: #6b7a8a;
  --accent: #0a6b3b;
  --accent-2: #2a8a55;
  --background: #e0f7fa;
  --font-family: 'Poppins', sans-serif;
  --border-light: #dce3ea;
  --radius: 12px;
  --shadow: rgba(0,0,0,0.1);
}

body {
  font-family: var(--font-family);
  background-color: var(--background);
  margin:0;
  padding:20px;
  display:flex;
  justify-content:center;
  align-items:flex-start;
}

.container {
  width:100%;
  max-width:950px;
  padding:2.5rem 3rem;
  background-color:var(--card);
  box-shadow:0 8px 20px var(--shadow);
  border-radius:var(--radius);
}

h1 { text-align:center; font-size:2rem; color:var(--accent); margin-bottom:1rem; }
h2 { font-size:1.4rem; color:var(--accent-2); margin-bottom:0.75rem; }

.section-card {
  background-color:#f8fbff;
  border:1px solid var(--border-light);
  border-radius:var(--radius);
  padding:20px;
  margin-bottom:20px;
}

.field-row {
  display:flex;
  align-items:center;
  margin-bottom:12px;
  flex-wrap:wrap;
}
.field-row label {
  width:200px;
  font-weight:600;
  margin-right:10px;
}
.field-row input, .field-row select, .field-row textarea {
  flex:1;
  padding:10px;
  border-radius:8px;
  border:1px solid #ccc;
  font-size:1rem;
  background:#fafafa;
}
.field-row input:disabled { background:#eee; color:#555; }

.checkbox-row {
  margin-bottom:12px;
  font-weight:600;
}

.buttons {
  display:flex;
  gap:1rem;
  flex-wrap:wrap;
  margin-top:15px;
}
.buttons button {
  padding:14px;
  font-size:1rem;
  font-weight:600;
  border:none;
  border-radius:8px;
  flex:1 1 48%;
  cursor:pointer;
  transition: background 0.3s ease;
  background-color: var(--accent);
  color:white;
}
.buttons button:hover { background-color:var(--accent-2); }

.nested-section {
  background: #fdfdfd;
  border-left: 3px solid var(--accent-2);
  margin: 12px 0 0 15px;
  padding: 12px 15px;
  border-radius: var(--radius);
}
.nested-section .field-row label { width: 180px; }

@media(max-width:768px){
  .field-row { flex-direction:column; align-items:flex-start; }
  .field-row label { width:100%; margin-bottom:5px; }
  .buttons { flex-direction:column; }
  .buttons button{width:100%;}
}
</style>
</head>

<body>
<main class="container">
  <h1>Visa Application Form</h1>

  <!-- Personal Details -->
  <div class="section-card">
    <h2>Personal Details</h2>
    <div class="field-row"><label>Booking Number</label><input id="booking_number" disabled></div>
    <div class="field-row"><label>ID Number</label><input id="id_number" disabled></div>
    <div class="field-row"><label>Full Forenames</label><input id="forenames" disabled></div>
    <div class="field-row"><label>Surname</label><input id="surname" disabled></div>
    <div class="field-row"><label>Email</label><input id="email" disabled></div>
    <div class="field-row"><label>Cellphone</label><input id="cellphone_full" disabled></div>
    <div class="field-row"><label>Country</label><input id="country" disabled></div>
    <div class="field-row"><label>Province/State</label><input id="location" disabled></div>
    <div class="field-row"><label>Office</label><input id="office" disabled></div>
    <div class="field-row"><label>Appointment Date</label><input id="appointment_date" disabled></div>
    <div class="field-row"><label>Appointment Time</label><input id="appointment_time" disabled></div>
  </div>

  <!-- Spouse Section -->
  <div class="section-card">
    <h2>Spouse</h2>
    <div class="checkbox-row">
      <label>Include Spouse?</label>
      <label><input type="radio" name="include_spouse" value="yes" onclick="toggleSpouse(true)"> Yes</label>
      <label><input type="radio" name="include_spouse" value="no" onclick="toggleSpouse(false)"> No</label>
    </div>
    <div id="spouse_details" class="nested-section" style="display:none;">
      <div class="field-row"><label>Full Name</label><input type="text" id="spouse_name"></div>
      <div class="field-row"><label>Surname</label><input type="text" id="spouse_surname"></div>
      <div class="field-row"><label>ID/Passport Number</label><input type="text" id="spouse_id"></div>
      <div class="field-row"><label>Upload Identity Document</label><input type="file" id="spouse_doc"></div>
    </div>
  </div>

  <!-- Children Section -->
  <div class="section-card">
    <h2>Children</h2>
    <div class="checkbox-row">
      <label>Include Children?</label>
      <label><input type="radio" name="include_children" value="yes" onclick="toggleChildren(true)"> Yes</label>
      <label><input type="radio" name="include_children" value="no" onclick="toggleChildren(false)"> No</label>
    </div>
    <div id="children_details" class="nested-section" style="display:none;">
      <p><em>You may add up to 5 children (under 18 years)</em></p>
      <div id="children_container"></div>
      <button type="button" onclick="addChild()">+ Add Child</button>
    </div>
  </div>

  <!-- Passport Section -->
  <div class="section-card">
    <h2>Passport Details</h2>
    <div class="checkbox-row">
      <label>Do you have a passport?</label>
      <label><input type="radio" name="have_passport" value="yes" onclick="togglePassport(true)"> Yes</label>
      <label><input type="radio" name="have_passport" value="no" onclick="togglePassport(false)"> No</label>
    </div>
    <div id="passport_details" class="nested-section" style="display:none;">
      <div class="field-row"><label>Passport Number</label><input type="text" id="passport_number"></div>
      <div class="field-row"><label>Expiry Date</label><input type="date" id="passport_expiry"></div>
      <div class="field-row"><label>Upload Passport</label><input type="file" id="passport_upload"></div>
    </div>
    <div id="passport_no_details" class="nested-section" style="display:none;">
      <p>Would you like to apply for a passport?</p>
      <label><input type="radio" name="apply_passport" value="yes"> Yes</label>
      <label><input type="radio" name="apply_passport" value="no"> No</label>
    </div>
  </div>

  <!-- Downloads Section -->
  <div class="section-card">
    <h2>Download Documents</h2>
    <div class="buttons">
      <a href="docs/main-visa.pdf" download><button type="button">Download Main Visa PDF</button></a>
      <a href="docs/medical.pdf" download><button type="button">Download Medical PDF</button></a>
      <a href="docs/home-affairs-service-charter.pdf" download><button type="button">Download Service Charter</button></a>
    </div>
  </div>

  <!-- Uploads Section -->
  <div class="section-card">
    <h2>Upload Required Documents</h2>
    <div class="field-row"><label>Visa Form</label><input type="file" id="visa_form_upload"></div>
    <div class="field-row"><label>Other Supporting Documents</label><input type="file" id="other_docs_upload" multiple></div>
    <div class="field-row"><label>Proof of Booking - Flight Invoice/Receipt</label><input type="file" id="proof_booking_upload"></div>
    <div class="field-row"><label>Travel Itinerary</label><input type="file" id="itinerary_upload"></div>
    <div class="field-row"><label>Travel Insurance</label><input type="file" id="insurance_upload"></div>
    <div class="field-row"><label>Fingerprint Clearance (Afiswitch)</label><input type="file" id="fingerprint_upload"></div>
    <div class="field-row"><label>Medical Records</label><input type="file" id="medical_upload"></div>
  </div>

  <div class="buttons">
    <button type="button" onclick="window.location.href='summary.html'">Back to Summary</button>
    <button type="button" onclick="submitVisaApplication()">Submit Application</button>
  </div>
</main>

<script>
// Toggle spouse section
function toggleSpouse(show){
  document.getElementById("spouse_details").style.display = show ? "block" : "none";
}

// Toggle children section
function toggleChildren(show){
  document.getElementById("children_details").style.display = show ? "block" : "none";
}
let childCount = 0;
function addChild(){
  if(childCount >= 5){ alert("Maximum 5 children allowed."); return; }
  childCount++;
  const container = document.getElementById("children_container");
  const childDiv = document.createElement("div");
  childDiv.classList.add("nested-section");
  childDiv.innerHTML = `
    <div class="field-row"><label>Child ${childCount} Name</label><input type="text"></div>
    <div class="field-row"><label>Surname</label><input type="text"></div>
    <div class="field-row"><label>Birth Certificate Upload</label><input type="file"></div>
    <div class="field-row"><label>School Report (if 5+)</label><input type="file"></div>
  `;
  container.appendChild(childDiv);
}

// Toggle passport section
function togglePassport(has){
  document.getElementById("passport_details").style.display = has ? "block" : "none";
  document.getElementById("passport_no_details").style.display = !has ? "block" : "none";
}

// Load booking data
window.onload = function(){
  const bookingData = JSON.parse(localStorage.getItem("bookingData"));
  if(bookingData){
    document.getElementById("booking_number").value = bookingData.booking_number || "";
    document.getElementById("id_number").value = bookingData.id_number || "";
    document.getElementById("forenames").value = bookingData.forenames || "";
    document.getElementById("surname").value = bookingData.surname || "";
    document.getElementById("email").value = bookingData.email || "";
    document.getElementById("cellphone_full").value = (bookingData.country_code||"") + " " + (bookingData.cellphone||"");
    document.getElementById("country").value = bookingData.country || "";
    document.getElementById("location").value = bookingData.location || "";
    document.getElementById("office").value = bookingData.office || "";
    document.getElementById("appointment_date").value = bookingData.appointment_date || "";
    document.getElementById("appointment_time").value = bookingData.appointment_time || "";
  }
};

function submitVisaApplication(){
  alert("Visa Application submitted!");
}
</script>
</body>
</html>
