<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Global Visa Application</title>
<style>
body{font-family:Arial,sans-serif;background:#f0f4f8;padding:20px}
h1,h2{color:#0a6b3b;text-align:center;margin-bottom:10px}
form{max-width:900px;margin:0 auto;background:#fff;padding:2rem;border-radius:12px;box-shadow:0 8px 20px rgba(0,0,0,0.1)}
label{font-weight:600;margin-top:10px;display:block}
input,select{width:100%;padding:10px;margin-bottom:15px;border-radius:6px;border:1px solid #ccc}
button{padding:12px 20px;background:#0a6b3b;color:#fff;border:none;border-radius:6px;cursor:pointer;margin-top:15px}
button:hover{background:#2a8a55}
.hidden{display:none}
.child-block, .spouse-block{margin-bottom:15px;border:1px solid #ccc;padding:10px;border-radius:6px}
</style>
</head>
<body>
<h1>Global Visa Application</h1>
<form id="visaForm">
<label for="booking_reference">Booking Reference</label>
<input type="text" id="booking_reference" readonly>

<label for="id_number">ID Number</label>
<input type="text" id="id_number" name="id_number" required>

<label for="forenames">Forenames</label>
<input type="text" id="forenames" name="forenames" required>

<label for="surname">Surname</label>
<input type="text" id="surname" name="surname" required>

<label for="contact">Contact Number</label>
<div style="display:flex; gap:10px;">
<select id="country_code">
<option value="+27">+27 (ZA)</option>
<option value="+44">+44 (UK)</option>
<option value="+61">+61 (AU)</option>
<option value="+1">+1 (US)</option>
<option value="+91">+91 (IN)</option>
<option value="+49">+49 (DE)</option>
<option value="+33">+33 (FR)</option>
<option value="+81">+81 (JP)</option>
<option value="+86">+86 (CN)</option>
<option value="+7">+7 (RU)</option>
</select>
<input type="tel" id="contact" name="contact" required>
</div>

<label for="email">Email</label>
<input type="email" id="email" name="email" required>

<h2>Relocation Address</h2>
<label for="street_address">Street Address</label>
<input type="text" id="street_address" name="street_address" required>

<label for="country">Country</label>
<select id="country" name="country" required onchange="updateProvinces()">
<option value="">Select Country</option>
<option value="Australia">Australia</option>
<option value="United Kingdom">United Kingdom</option>
<option value="United States">United States</option>
<option value="Canada">Canada</option>
<option value="South Africa">South Africa</option>
<option value="India">India</option>
<option value="Germany">Germany</option>
<option value="France">France</option>
<option value="Japan">Japan</option>
<option value="China">China</option>
<option value="Russia">Russia</option>
</select>

<label for="province">Province / State</label>
<select id="province" name="province" required onchange="updateCities()">
<option value="">Select Province/State</option>
</select>

<label for="city">City</label>
<select id="city" name="city" required onchange="updatePostal()">
<option value="">Select City</option>
</select>

<label for="postal">Postal Code</label>
<select id="postal" name="postal" required>
<option value="">Select Postal Code</option>
</select>

<h2>Passport Details</h2>
<label>Do you have a passport?</label>
<div>
<input type="radio" name="passport_status" value="yes"> Yes
<input type="radio" name="passport_status" value="no"> No
</div>
<div id="passport-extra" class="hidden">
<label for="passport_issue">Intended Issue Date</label>
<input type="date" id="passport_issue" name="passport_issue">
<label for="passport_proof">Upload Passport Proof</label>
<input type="file" id="passport_proof" name="passport_proof">
</div>

<label for="visa_type">Visa Type</label>
<select id="visa_type" name="visa_type">
<option value="Relocation">Relocation</option>
<option value="Sponsorship">Sponsorship</option>
<option value="Work Visa">Work Visa</option>
</select>

<h2>Spouse</h2>
<label>Include Spouse?</label>
<div>
<input type="radio" name="spouse_include" value="yes"> Yes
<input type="radio" name="spouse_include" value="no"> No
</div>
<div id="spouse-section" class="hidden spouse-block">
<label for="spouse_name">Spouse Name</label>
<input type="text" id="spouse_name" name="spouse_name">
<label for="spouse_age">Spouse Age</label>
<input type="number" id="spouse_age" name="spouse_age">
<label for="spouse_id">Spouse ID Document</label>
<input type="file" id="spouse_id" name="spouse_id">
<label for="spouse_medical">Spouse Medical Records</label>
<input type="file" id="spouse_medical" name="spouse_medical">
</div>

<h2>Children</h2>
<label>Include Children?</label>
<div>
<input type="radio" name="children_include" value="yes"> Yes
<input type="radio" name="children_include" value="no"> No
</div>
<div id="children-section" class="hidden">
<label for="child_count">Number of Children</label>
<select id="child_count">
<option value="0">0</option>
<option value="1">1</option>
<option value="2">2</option>
<option value="3">3</option>
<option value="4">4</option>
<option value="5">5</option>
</select>
<div id="children-details"></div>
</div>

<button type="submit">Submit Visa Application</button>
</form>

<script>
// Example country > provinces > cities > postal
const countryData = {
  "Australia": { "New South Wales":["Sydney","Newcastle"],"Victoria":["Melbourne","Geelong"] },
  "United Kingdom": { "England":["London","Manchester"],"Scotland":["Edinburgh","Glasgow"] },
  "United States": { "California":["Los Angeles","San Francisco"],"New York":["New York","Buffalo"] },
  "Canada": { "Ontario":["Toronto","Ottawa"],"Quebec":["Montreal","Quebec City"] },
  "South Africa": { "Gauteng":["Johannesburg","Pretoria"],"Western Cape":["Cape Town","Stellenbosch"] }
};

const postalData = {
  "Sydney": ["2000","2001"], "Melbourne":["3000","3001"], "London":["SW1A","EC1A"], 
  "Manchester":["M1","M2"], "Edinburgh":["EH1","EH2"], "Glasgow":["G1","G2"],
  "Los Angeles":["90001","90002"], "San Francisco":["94101","94102"],
  "New York":["10001","10002"], "Buffalo":["14201","14202"],
  "Toronto":["M5H","M4B"], "Ottawa":["K1A","K2P"], "Montreal":["H1A","H2B"], "Quebec City":["G1A","G2B"],
  "Johannesburg":["2000","2001"], "Pretoria":["0001","0002"], "Cape Town":["8000","8001"], "Stellenbosch":["7600","7601"]
};

function updateProvinces() {
  const country = document.getElementById("country").value;
  const province = document.getElementById("province");
  province.innerHTML = "<option value=''>Select Province/State</option>";
  document.getElementById("city").innerHTML = "<option value=''>Select City</option>";
  document.getElementById("postal").innerHTML = "<option value=''>Select Postal Code</option>";
  if(countryData[country]){
    Object.keys(countryData[country]).forEach(p=>{const o=document.createElement("option");o.value=p;o.textContent=p;province.appendChild(o);});
  }
}
function updateCities(){
  const country=document.getElementById("country").value;
  const province=document.getElementById("province").value;
  const city=document.getElementById("city");
  city.innerHTML="<option value=''>Select City</option>";
  document.getElementById("postal").innerHTML = "<option value=''>Select Postal Code</option>";
  if(countryData[country] && countryData[country][province]){
    countryData[country][province].forEach(c=>{const o=document.createElement("option");o.value=c;o.textContent=c;city.appendChild(o);});
  }
}
function updatePostal(){const c=document.getElementById("city").value;const p=document.getElementById("postal");p.innerHTML="<option value=''>Select Postal Code</option>";if(postalData[c]){postalData[c].forEach(code=>{const o=document.createElement("option");o.value=code;o.textContent=code;p.appendChild(o);});}}

window.onload=function(){
  document.querySelectorAll('input[name=passport_status]').forEach(el=>el.addEventListener('change',()=>{document.getElementById('passport-extra').classList.toggle('hidden',el.value!=='yes'||!el.checked);}));
  document.querySelectorAll('input[name=spouse_include]').forEach(el=>el.addEventListener('change',()=>{document.getElementById('spouse-section').classList.toggle('hidden',el.value!=='yes'||!el.checked);}));
  document.querySelectorAll('input[name=children_include]').forEach(el=>el.addEventListener('change',()=>{document.getElementById('children-section').classList.toggle('hidden',el.value!=='yes'||!el.checked);}));
  document.getElementById('child_count').addEventListener('change',e=>{renderChildren(parseInt(e.target.value));});

  const bookingData=JSON.parse(localStorage.getItem('bookingData'));
  if(bookingData){
    document.getElementById('id_number').value=bookingData.id_number||'';
    document.getElementById('forenames').value=bookingData.forenames||'';
    document.getElementById('surname').value=bookingData.surname||'';
    document.getElementById('contact').value=bookingData.contact||'';
    document.getElementById('email').value=bookingData.email||'';
  }
};

function renderChildren(count){
  const container=document.getElementById('children-details');
  container.innerHTML='';
  for(let i=1;i<=count;i++){
    const div=document.createElement('div');
    div.classList.add('child-block');
    div.innerHTML=`
      <h3>Child ${i}</h3>
      <label>Name</label><input type="text" name="child_${i}_name" required>
      <label>Age</label><input type="number" name="child_${i}_age" required>
      <label>Birth Certificate Number</label><input type="text" name="child_${i}_birth" required>
      <label>Medical Records</label><input type="file" name="child_${i}_medical" required>
    `;
    container.appendChild(div);
  }
}

document.getElementById("visaForm").addEventListener("submit",function(e){
  e.preventDefault();
  if(!this.checkValidity()){alert("⚠️ Complete all fields.");return;}
  const formData=new FormData(this);
  const appData={};
  formData.forEach((v,k)=>appData[k]=v);
  localStorage.setItem("visaApplication",JSON.stringify(appData));
  alert("Application submitted successfully!");
});
</script>
</body>
</html>
